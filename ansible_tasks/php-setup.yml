- name: Installation install software-properties-common
  apt: name=software-properties-common
  tags:
    - php

- name: "Repo PHP 8.2"
  apt_repository:
    repo="ppa:ondrej/php"
  tags:
    - php

- name: "Updating the repo"
  apt: update_cache=yes
  tags:
    - php

- name: Installation PHP 8.2
  apt: name=php8.2 state=present
  tags:
    - php

- name: install lamp stack
  apt:
    pkg:
      - php8.2-mysql
      - php8.2-curl
      - php8.2-json
      - php8.2-cgi
      - php8.2-xsl
      - php8.2-cgi
      - php8.2-gd
      - php8.2-mbstring
      - php8.2-zip
      - php8.2-xmlrpc
      - php8.2-soap
      - php8.2-intl
      - libapache2-mod-php
    state: present
    update_cache: yes 
  tags:
    - php
# Composer
# Install Composer the lightweight way (without using installer)
# https://getcomposer.org/download
- name: Composer | Install Composer latest-stable
  get_url:
    url: 'https://getcomposer.org/download/latest-stable/composer.phar'
    checksum: 'sha256:https://getcomposer.org/download/latest-stable/composer.phar.sha256sum'
    dest: /usr/local/bin/composer.phar
    mode: 0755
  tags:
    - php

- name: Composer | Symlink composer.phar
  file:
    src: composer.phar
    dest: /usr/local/bin/composer
    state: link
  tags:
    - php