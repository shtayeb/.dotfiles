# GUI tools installation (requires sudo for apt)

- name: Add universe repository
  become: true
  shell: add-apt-repository -y universe
  changed_when: false
  tags: [gui-tools, install]

- name: Install GUI packages
  become: true
  apt:
    name:
      - gimp
      - screenkey
      - shutter
      - vlc
      - copyq
      - wget
      - gpg
      - apt-transport-https
    state: present
  tags: [gui-tools, install]

# TablePlus
- name: Add TablePlus GPG key
  become: true
  shell: wget -qO - https://deb.tableplus.com/apt.tableplus.com.gpg.key | gpg --dearmor -o /etc/apt/trusted.gpg.d/tableplus-archive.gpg
  args:
    creates: /etc/apt/trusted.gpg.d/tableplus-archive.gpg
  tags: [gui-tools, install]

- name: Add TablePlus repository
  become: true
  apt_repository:
    repo: "deb [arch=amd64] https://deb.tableplus.com/debian/22 tableplus main"
    state: present
  tags: [gui-tools, install]

- name: Install TablePlus
  become: true
  apt:
    name: tableplus
    state: present
    update_cache: yes
  tags: [gui-tools, install]

# VS Code
- name: Download Microsoft GPG key
  get_url:
    url: https://packages.microsoft.com/keys/microsoft.asc
    dest: /tmp/microsoft.asc
    mode: '0644'
  tags: [gui-tools, install]

- name: Install Microsoft GPG key
  become: true
  shell: cat /tmp/microsoft.asc | gpg --dearmor -o /etc/apt/keyrings/packages.microsoft.gpg
  args:
    creates: /etc/apt/keyrings/packages.microsoft.gpg
  tags: [gui-tools, install]

- name: Ensure keyrings directory exists
  become: true
  file:
    path: /etc/apt/keyrings
    state: directory
    mode: '0755'
  tags: [gui-tools, install]

- name: Add VS Code repository
  become: true
  apt_repository:
    repo: "deb [arch=amd64,arm64,armhf signed-by=/etc/apt/keyrings/packages.microsoft.gpg] https://packages.microsoft.com/repos/code stable main"
    state: present
    filename: vscode
  tags: [gui-tools, install]

- name: Install VS Code
  become: true
  apt:
    name: code
    state: present
    update_cache: yes
  tags: [gui-tools, install]

- name: Clean up temp files
  file:
    path: /tmp/microsoft.asc
    state: absent
  tags: [gui-tools, install]
